"use strict";(self.webpackChunkflashcard_=self.webpackChunkflashcard_||[]).push([[751],{87023:function(re,Z,t){t.r(Z),t.d(Z,{default:function(){return Ae}});var $=t(55354),T=t.n($),ae=t(50680),d=t.n(ae),E=t(93981),G=t(7616),oe=t(21839),ie=t(85098),A=t(29895),v=t(55898),X=t(60505),l=t(95563),B=t(70765),W=t(86541),s=t(67604),se=t(80975),w=t(81445),le=t(89966),r=t(37401),o=t(88556),u=t(59042),i=t.n(u),m=t(35572),h=t(80483),j=t(17818),H=t(23660),z=t(54320),L=t(93829),ue=t(84937),Y=t(60711),xe=t(30583),P=t.n(xe),e=t(29541),p=ue.e+"-record-item",ke=m.Z.useToken,Ie=function(y){var U=y.onClick,x=y.onRemoveClick,b=y.onEditClick,de=y.onSyncClick,ve=y.selected,S=y.record,C=S._id,O=S.source,M=S.translation,f=S.exp;function J(F){F.stopPropagation(),U(C)}var he=function(R){R.stopPropagation(),b(S)},q=function(R){R==null||R.stopPropagation(),x(C)};function _(F){F==null||F.stopPropagation()}var D=ke(),me=D.theme,K=D.token,N=D.hashId,Q=(0,Y.xy)({theme:me,token:K,hashId:N,path:[p]},function(){return[Ee(K)]});return Q((0,e.jsxs)("div",{className:P()("".concat(p,"-record-card"),N),onClick:J,children:[(0,e.jsx)("div",{className:P()("".concat(p,"-progress"),N),style:{width:f}}),(0,e.jsx)("div",{className:P()(P()("".concat(p,"-check"),N),ve&&P()("".concat(p,"-selected"),N))}),(0,e.jsx)("div",{style:{whiteSpace:"pre-wrap"},onClick:J,children:O}),(0,e.jsx)(h.Z,{}),(0,e.jsx)("div",{style:{whiteSpace:"pre-wrap"},onClick:J,children:M}),(0,e.jsxs)("div",{className:P()("".concat(p,"-tools-bar"),N),children:[(0,e.jsx)(l.ZP,{size:"small",type:"text",onClick:de,icon:(0,e.jsx)(H.Z,{})}),(0,e.jsx)(l.ZP,{size:"small",type:"text",onClick:he,icon:(0,e.jsx)(z.Z,{})}),(0,e.jsx)(j.Z,{title:"\u64CD\u4F5C\u4E0D\u53EF\u9006\uFF0C\u8BF7\u786E\u8BA4",onConfirm:q,onCancel:_,children:(0,e.jsx)(l.ZP,{size:"small",type:"text",danger:!0,onClick:_,icon:(0,e.jsx)(L.Z,{})})})]})]}))},Ee=function(U){var x;return x={},i()(x,".".concat(p,"-record-card"),{position:"relative",height:"100%",width:"100%",padding:"12px",overflowWrap:"break-word",backgroundColor:"#fff","&:hover .check":{visibility:"visible"}}),i()(x,".".concat(p,"-tools-bar"),{position:"absolute",top:"0",right:"12px"}),i()(x,".".concat(p,"-progress"),{position:"absolute",bottom:"0",left:"0",height:"2px",backgroundImage:"linear-gradient(to right, red, lightgreen)"}),i()(x,".".concat(p,"-check"),{position:"absolute",top:"0",left:"0",width:"1px",height:"100%",backgroundColor:U.colorPrimary,visibility:"hidden"}),i()(x,".".concat(p,"-selected"),{visibility:"visible"}),x},V=t(86003),ce=15,Ae=function(){var y,U=v.Z.useForm(),x=d()(U,1),b=x[0],de=v.Z.useForm(),ve=d()(de,1),S=ve[0],C=(0,G.s0)(),O=(0,G.TH)(),M=O.search,f=new URLSearchParams(M),J=[f.get("type")||"all"],he=(0,E.useState)(!1),q=d()(he,2),_=q[0],D=q[1],me=(0,E.useState)(!1),K=d()(me,2),N=K[0],Q=K[1],F=(0,E.useState)("\u65B0\u5EFA"),R=d()(F,2),fe=R[0],Se=R[1],De=(0,E.useState)([]),je=d()(De,2),ee=je[0],Pe=je[1],Ne=(0,E.useState)(),Ze=d()(Ne,2),ge=Ze[0],Re=Ze[1];(0,E.useEffect)(function(){var n=new URLSearchParams(M);b.setFieldsValue(Object.fromEntries(n.entries()))},[M]);var k=(0,oe.NL)(),te=(0,ie.N)(["records-list",M],function(n){var a=n.pageParam,c=a===void 0?0:a,g=Object.fromEntries(new URLSearchParams(M));return o.iP.get("/flashcard/record/list",{notify:"fail",params:T()(T()({},g),{},{skip:c*ce,limit:ce})})},{getNextPageParam:function(a,c){var g;return(a==null||(g=a.data)===null||g===void 0?void 0:g.length)===ce?c==null?void 0:c.length:void 0}}),pe=te.data,Te=te.fetchNextPage,ze=te.hasNextPage,ye=te.isFetching,I=pe==null?void 0:pe.pages,ne=I==null?void 0:I.reduce(function(n,a){return n.concat(a==null?void 0:a.data)},[]),Me=(I==null||(y=I[(I==null?void 0:I.length)-1])===null||y===void 0?void 0:y.total)||0,Qe=(0,A.D)(function(n){return o.iP.post("/flashcard/record/create",n)},{onSuccess:function(){k.invalidateQueries(["records-list"]),S.resetFields(),Q(!1)}}),be=(0,A.D)(function(n){return o.iP.patch("/flashcard/record/update",T()({id:ge==null?void 0:ge._id},n))},{onSuccess:function(){k.invalidateQueries(["records-list"]),S.resetFields(),Q(!1)}}),Oe=(0,A.D)(function(n){return o.iP.delete("/flashcard/record/remove/".concat(n))},{onSuccess:function(){k.invalidateQueries(["records-list"])}}),$e=(0,A.D)(function(n){return o.iP.patch("/flashcard/record/review",{ids:n})},{onSuccess:function(){k.invalidateQueries(["records-list"]),k.invalidateQueries(["review-list"]),C("/review/")}}),Be=(0,A.D)(function(n){return o.iP.patch("/flashcard/record/random-review",n)},{onSuccess:function(){k.invalidateQueries(["records-list"]),k.invalidateQueries(["review-list"]),C("/review/")}}),He=(0,A.D)(function(n){return o.iP.get("/flashcard/record/review-all")},{onSuccess:function(){k.invalidateQueries(["records-list"]),k.invalidateQueries(["review-list"]),C("/review/")}});function Le(){$e.mutate(ee)}function Ve(){Be.mutate()}function Ue(){He.mutate()}var Je=function(a){var c=a.key;c!=="all"?f.set("type","".concat(c)):f.delete("type"),C({pathname:O.pathname,search:f.toString()})};function Ke(){D(!0)}function Ge(){D(!1)}function Ce(){b.validateFields().then(function(n){var a=n.sort,c=n.orderby;f.set("sort",a),f.set("orderby",c),C({pathname:O.pathname,search:f.toString()}),D(!1)})}function Xe(){f.delete("sort"),f.delete("orderby"),C({pathname:O.pathname,search:f.toString()}),b.resetFields(),D(!1)}function We(n){Se(n.currentTarget.dataset.inputType),Q(!0)}function we(){Q(!1)}function Fe(){S.validateFields().then(function(n){switch(fe){case"\u65B0\u5EFA":Qe.mutate(n);break;case"\u7F16\u8F91":be.mutate(n);break;default:console.error("invalidate type:",fe)}})}function Ye(n){Pe(function(a){var c=a.some(function(g){return g===n});return c?a.filter(function(g){return g!==n}):a.concat(n)})}function qe(n){Oe.mutate(n)}function _e(n){S.setFieldsValue(n),Re(n),Se("\u7F16\u8F91"),Q(!0)}function et(){Pe([])}var tt=function(){return ye?Promise.resolve():Te()},nt=function(a){var c=ee.some(function(g){return g===(a==null?void 0:a._id)});return(0,e.jsx)(X.ZP.Item,{children:(0,e.jsx)(Ie,{record:a,selected:c,onClick:Ye,onEditClick:_e,onSyncClick:function(ot){ot.stopPropagation()},onRemoveClick:qe})},a==null?void 0:a._id)},rt=ye?null:(0,e.jsx)("div",{style:{textAlign:"center",margin:"12px auto",height:32,lineHeight:"32px"},children:ze?(0,e.jsx)(l.ZP,{onClick:tt,children:"\u52A0\u8F7D\u66F4\u591A..."}):"\u6CA1\u6709\u66F4\u591A\u4E86"}),at=[{key:"enable",label:"\u53EF\u590D\u4E60"},{key:"cooling",label:"\u51B7\u5374\u4E2D"},{key:"done",label:"\u5DF1\u5B8C\u6210"},{key:"all",label:"\u5168\u90E8"}];return(0,e.jsxs)("section",{children:[(0,e.jsx)("header",{style:{height:24},children:(0,e.jsxs)("div",{className:V.Z.header,children:[(0,e.jsx)(B.Z,{className:V.Z.menu,mode:"horizontal",onSelect:Je,selectedKeys:J,items:at}),(0,e.jsx)(l.ZP,{type:"link",size:"small",onClick:Ke,children:"\u6392\u5E8F"}),(0,e.jsx)(W.Z,{open:_,title:"\u6392\u5E8F",onCancel:Ge,onOk:Ce,children:(0,e.jsxs)(v.Z,{onFinish:Ce,form:b,children:[(0,e.jsx)(v.Z.Item,{name:"sort",label:"\u6392\u5E8F\u5173\u952E\u5B57",rules:[{required:!0}],children:(0,e.jsxs)(s.ZP.Group,{children:[(0,e.jsx)(s.ZP.Button,{value:"reviewAt",children:"\u590D\u4E60\u65F6\u95F4"}),(0,e.jsx)(s.ZP.Button,{value:"createAt",children:"\u6DFB\u52A0\u65F6\u95F4"}),(0,e.jsx)(s.ZP.Button,{value:"exp",children:"\u719F\u7EC3\u5EA6"})]})}),(0,e.jsx)(v.Z.Item,{name:"orderby",label:"\u6392\u5E8F\u65B9\u5411",rules:[{required:!0}],children:(0,e.jsxs)(s.ZP.Group,{children:[(0,e.jsx)(s.ZP.Button,{value:"1",children:"\u5347\u5E8F"}),(0,e.jsx)(s.ZP.Button,{value:"-1",children:"\u964D\u5E8F"})]})}),(0,e.jsx)(v.Z.Item,{children:(0,e.jsx)(l.ZP,{style:{opacity:0},htmlType:"submit",children:"\u63D0\u4EA4"})}),(0,e.jsx)(v.Z.Item,{children:(0,e.jsx)(l.ZP,{type:"dashed",danger:!0,onClick:Xe,children:"\u53D6\u6D88\u6392\u5E8F"})})]})})]})}),(0,e.jsx)("main",{className:V.Z.content,children:ne!=null&&ne.length?(0,e.jsx)(X.ZP,{dataSource:ne,style:{background:"#f0f2f5"},renderItem:nt,loading:ye,loadMore:rt}):(0,e.jsx)(se.Z,{className:V.Z.empty})}),(0,e.jsx)("footer",{children:(0,e.jsxs)("div",{className:V.Z.footer,children:[(0,e.jsxs)(w.Z,{style:{marginRight:"12px"},children:[ee.length,"/",Me,(0,e.jsx)(l.ZP,{size:"small",type:"dashed",onClick:et,children:"\u53D6\u6D88\u9009\u62E9"})]}),(0,e.jsxs)(w.Z,{children:[(0,e.jsx)(l.ZP,{size:"small",type:"primary",disabled:!ee.length,onClick:Le,children:"\u590D\u4E60\u6240\u9009"}),(0,e.jsx)(l.ZP,{size:"small",type:"primary",onClick:Ve,children:"\u968F\u673A\u590D\u4E60"}),(0,e.jsx)(l.ZP,{size:"small",type:"primary",onClick:Ue,children:"\u590D\u4E60\u5168\u90E8"}),(0,e.jsx)(l.ZP,{size:"small",type:"primary",shape:"circle",icon:(0,e.jsx)(r.Z,{}),onClick:We,"data-input-type":"\u65B0\u5EFA"})]})]})}),(0,e.jsx)(W.Z,{title:fe,open:N,onCancel:we,onOk:Fe,children:(0,e.jsxs)(v.Z,{form:S,onFinish:Fe,children:[(0,e.jsx)(v.Z.Item,{name:"source",label:"\u539F\u6587",rules:[{required:!0}],children:(0,e.jsx)(le.Z.TextArea,{autoSize:!0,allowClear:!0})}),(0,e.jsx)(v.Z.Item,{name:"translation",label:"\u8BD1\u6587",rules:[{required:!0}],children:(0,e.jsx)(le.Z.TextArea,{autoSize:!0,allowClear:!0})}),(0,e.jsx)(v.Z.Item,{children:(0,e.jsx)(l.ZP,{style:{opacity:0},htmlType:"submit",children:"\u63D0\u4EA4"})})]})})]})}},84937:function(re,Z,t){t.d(Z,{e:function(){return T}});var $={token:{colorPrimary:"#002766"}},T="flashcard";Z.Z=$},88556:function(re,Z,t){t.d(Z,{iP:function(){return s}});var $=t(59042),T=t.n($),ae=t(55354),d=t.n(ae),E=t(24700),G=t(33813),oe=t(93981),ie=t.t(oe,2),A=t(32841),v=t(17635),X={antd:E,reactQuery:G,react:ie,reactDnD:A,reactRouterDom:v},l=t(28983),B=X.antd.message,W={200:"\u64CD\u4F5C\u6210\u529F\u3002",201:"\u65B0\u5EFA\u6216\u4FEE\u6539\u6570\u636E\u6210\u529F\u3002",202:"\u4E00\u4E2A\u8BF7\u6C42\u5DF2\u7ECF\u8FDB\u5165\u540E\u53F0\u6392\u961F\uFF08\u5F02\u6B65\u4EFB\u52A1\uFF09\u3002",204:"\u5220\u9664\u6570\u636E\u6210\u529F\u3002",400:"\u53D1\u51FA\u7684\u8BF7\u6C42\u6709\u9519\u8BEF\uFF0C\u670D\u52A1\u5668\u6CA1\u6709\u8FDB\u884C\u65B0\u5EFA\u6216\u4FEE\u6539\u6570\u636E\u7684\u64CD\u4F5C\u3002",401:"\u7528\u6237\u6CA1\u6709\u6743\u9650\uFF08\u4EE4\u724C\u3001\u7528\u6237\u540D\u3001\u5BC6\u7801\u9519\u8BEF\uFF09\u3002",403:"\u7528\u6237\u5F97\u5230\u6388\u6743\uFF0C\u4F46\u662F\u8BBF\u95EE\u662F\u88AB\u7981\u6B62\u7684\u3002",404:"\u53D1\u51FA\u7684\u8BF7\u6C42\u9488\u5BF9\u7684\u662F\u4E0D\u5B58\u5728\u7684\u8BB0\u5F55\uFF0C\u670D\u52A1\u5668\u6CA1\u6709\u8FDB\u884C\u64CD\u4F5C\u3002",405:"\u8BF7\u6C42\u65B9\u5F0F\u4E0D\u5BF9",406:"\u8BF7\u6C42\u7684\u683C\u5F0F\u4E0D\u53EF\u5F97\u3002",410:"\u8BF7\u6C42\u7684\u8D44\u6E90\u88AB\u6C38\u4E45\u5220\u9664\uFF0C\u4E14\u4E0D\u4F1A\u518D\u5F97\u5230\u7684\u3002",422:"\u5F53\u521B\u5EFA\u4E00\u4E2A\u5BF9\u8C61\u65F6\uFF0C\u53D1\u751F\u4E00\u4E2A\u9A8C\u8BC1\u9519\u8BEF\u3002",500:"\u670D\u52A1\u5668\u53D1\u751F\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u670D\u52A1\u5668\u3002",502:"\u7F51\u5173\u9519\u8BEF\u3002",503:"\u670D\u52A1\u4E0D\u53EF\u7528\uFF0C\u670D\u52A1\u5668\u6682\u65F6\u8FC7\u8F7D\u6216\u7EF4\u62A4\u3002",504:"\u7F51\u5173\u8D85\u65F6\u3002"},s=l.Z.create({baseURL:"/api/",timeout:1e4,timeoutErrorMessage:"\u8FDE\u63A5\u8D85\u65F6\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u540E\u518D\u8BD5"});s.interceptors.request.use(function(r){return r.headers.setAuthorization("Bearer ".concat(localStorage.getItem("token"))),r}),s.interceptors.response.use(function(r){var o,u;if(r!=null&&(o=r.data)!==null&&o!==void 0&&o.ok)return r;var i={config:r.config,isAxiosError:!1,toJSON:function(){return{}},response:r,request:r.request,message:r==null||(u=r.data)===null||u===void 0?void 0:u.errMsg,name:"biz error"};throw i}),s.interceptors.response.use(function(r){var o,u,i=r.data,m=r.config;if((o=[!0,"success"])!==null&&o!==void 0&&o.includes((u=m==null?void 0:m.notify)!==null&&u!==void 0?u:!1)){var h=(i==null?void 0:i.message)||"\u64CD\u4F5C\u6210\u529F";B.success({content:h,key:h})}return i}),s.interceptors.response.use(void 0,function(r){var o,u=r!=null?r:{},i=u.response,m=u.message,h=u.config,j=h!=null?h:{},H=j.reAuth,z=j.notify,L=j.sneakyThrows;if((i==null?void 0:i.status)===401)return H?se(h):B.warning({key:i.status,content:"\u8BF7\u5148\u767B\u5F55",onClose:function(){var P,e;localStorage.removeItem("token"),(P=location.pathname)!==null&&P!==void 0&&(e=P.toLocaleLowerCase())!==null&&e!==void 0&&e.includes("/user-center/login/")||location.replace("/user-center/login/")}});if((o=[!0,"fail"])!==null&&o!==void 0&&o.includes(z!=null?z:!0)){var ue=m.match("Network Error")&&"\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u3002",Y=ue||m||W[i==null?void 0:i.status]||"\u672A\u77E5\u9519\u8BEF";B.error({key:Y,content:Y})}if(L)return i;throw r});function se(r){return s.get("/uc/oauth2/refresh",{reAuth:!1,notify:"fail",params:{token:localStorage.getStorage("refresh_token")}}).then(function(o){return localStorage.setItem("token",o.data.token),localStorage.setItem("refresh_token",o.data.refresh_token),s(d()(d()({},r),{},{reAuth:!1}))})}var w=["query","mutation"],le=w.reduce(function(r,o){return d()(d()({},r),{},T()({},o,function(u,i){return function(){for(var m=arguments.length,h=new Array(m),j=0;j<m;j++)h[j]=arguments[j];return s.post(u,d()({query:"".concat(o," {").concat(h[0].reduce(function(H,z,L){return H+z+(h[L+1]||"")},""),"}")},i))}}))},{})},86003:function(re,Z){Z.Z={content:"content___ttouV",header:"header___bRScu",menu:"menu___R1KbF",footer:"footer___QOC7J",empty:"empty___HT1XX"}}}]);
