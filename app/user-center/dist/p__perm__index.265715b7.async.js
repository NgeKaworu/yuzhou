"use strict";(self.webpackChunkuser_center_=self.webpackChunkuser_center_||[]).push([[385],{97147:function(k,U,e){e.d(U,{Ue:function(){return x},Vx:function(){return u},cn:function(){return K},pb:function(){return B},qn:function(){return _}});var M=e(44521),x=function(){for(var a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];return M.iP.post.apply(M.iP,["user-center/perm/create"].concat(o))},K=function(a){for(var o=arguments.length,n=new Array(o>1?o-1:0),f=1;f<o;f++)n[f-1]=arguments[f];return M.iP.delete.apply(M.iP,["user-center/perm/remove/".concat(a)].concat(n))},u=function(){for(var a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];return M.iP.put.apply(M.iP,["user-center/perm/update"].concat(o))},B=function(){for(var a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];return M.iP.get.apply(M.iP,["user-center/perm/list"].concat(o)).then(function(f){var P;return{data:(P=f.data)===null||P===void 0?void 0:P.sort(function(F,D){var p,h;return((p=F.order)!==null&&p!==void 0?p:0)-((h=D.order)!==null&&h!==void 0?h:0)})}})},_=function(){for(var a=arguments.length,o=new Array(a),n=0;n<a;n++)o[n]=arguments[n];return M.iP.get.apply(M.iP,["user-center/perm/validate"].concat(o))}},82078:function(k,U,e){e.r(U),e.d(U,{default:function(){return Re}});var M=e(34412),x=e.n(M),K=e(55354),u=e.n(K),B=e(69780),_=e.n(B),j=e(50680),a=e.n(j),o=e(93981),n=e(97147),f=e(80132),P=e(39891),F=e(48251),D=e(50852),p=e(56918),h=e(98034),E=e(48886),$=e(10130),G=e(30502),N=e(71866),q=e(89246),te=e(22173),ee=new Map([[!0,"\u662F"],[!1,"\u5426"]]),fe=e(27139),L=e.n(fe),pe=e(80211),he=e.n(pe),Ee=e(60852),Fe=e.n(Ee),ye=e(15738),Ce=e.n(ye),Me=e(59042),de=e.n(Me),je=function(){function m(d){Fe()(this,m),de()(this,"m",new Map),this.m=this.convertMap(d)}return Ce()(m,[{key:"convertMap",value:function(t){return t instanceof Map?new Map(t):he()(t)==="object"?new Map(Object==null?void 0:Object.entries(t)):(console.warn("invalid type: ".concat(t,", expect map or record")),new Map)}},{key:"copy",get:function(){return new m(this.m)}},{key:"unshift",value:function(t){return new m([].concat(L()(this.convertMap(t)),L()(this.m)))}},{key:"push",value:function(t){return new m(new Map([].concat(L()(this.m),L()(this.convertMap(t)))))}},{key:"insert",value:function(t,c){var l=L()(this.m),s=l.findIndex(function(I){var Z=a()(I,1),Y=Z[0];return t===Y});return new m(new Map([].concat(l.slice(0,s),L()(this.convertMap(c)),l.slice(s))))}},{key:"replace",value:function(t){var c=this.copy;return L()(this.convertMap(t)).forEach(function(l){var s=a()(l,2),I=s[0],Z=s[1];c=c.insert(I,Z).remove(I)}),c}},{key:"remove",value:function(){for(var t=this.copy,c=arguments.length,l=new Array(c),s=0;s<c;s++)l[s]=arguments[s];return l==null||l.forEach(function(I){return t.m.delete(I)}),t}},{key:"vk",get:function(){return new m(new Map(L()(this.m).map(function(t){var c=a()(t,2),l=c[0],s=c[1];return[s,l]})))}},{key:"toMap",get:function(){return this.copy.m}},{key:"toOpt",get:function(){return L()(this.m).map(function(t){var c=a()(t,2),l=c[0],s=c[1];return{label:s,value:l}})}},{key:"toObj",get:function(){return L()(this.m).reduce(function(t,c){var l=a()(c,2),s=l[0],I=l[1];return u()(u()({},t),{},de()({},s,I))},{})}}]),m}(),ue=function(m){return new je(m)},Pe=e(23663),r=e(29541),b=f.Z.Item,ae=P.ZP.Group,ge=function(d){return d[0]},De=function(d){return d===d.toUpperCase()},xe=function(m){var d=m.formProps,t=m.modalProps,c=m.setModalProps,l=m.onSuccess,s=m.form,I=(t==null?void 0:t.title)==="\u7F16\u8F91",Z=(0,G.a)(["user-center/perm/list","menu","infinity"],function(){return(0,n.pb)({params:{limit:0,isMenu:!0}})}),Y=Object.keys(E).reduce(function(V,g){return De(ge(g))&&g!=="IconProvider"?V.concat({value:g,label:(0,o.createElement)(E==null?void 0:E[g])}):V},[]);function z(){return W.apply(this,arguments)}function W(){return W=_()(x()().mark(function V(){var g,S;return x()().wrap(function(v){for(;;)switch(v.prev=v.next){case 0:return v.next=2,s==null?void 0:s.validateFields();case 2:if(g=v.sent,v.prev=3,c(function(T){return u()(u()({},T),{},{confirmLoading:!0})}),I?S=n.Vx:S=n.Ue,l!=null){v.next=10;break}v.t0=void 0,v.next=15;break;case 10:return v.t1=l,v.next=13,S(g);case 13:v.t2=v.sent,v.t0=(0,v.t1)(v.t2);case 15:return v.next=17,v.t0;case 17:c(function(T){return u()(u()({},T),{},{open:!1})}),Z.refetch(),s.resetFields();case 20:return v.prev=20,c(function(T){return u()(u()({},T),{},{confirmLoading:!1})}),v.finish(20);case 23:case"end":return v.stop()}},V,null,[[3,,20,23]])})),W.apply(this,arguments)}return(0,r.jsxs)($.Z,{formProps:u()({onFinish:z,initialValues:{isMenu:!0,isHide:!1,isMicroApp:!1}},d),modalProps:u()({onOk:z},t),children:[(0,r.jsx)(b,{name:"name",label:"\u6743\u9650\u540D",rules:[{required:!0}],children:(0,r.jsx)(F.Z,{placeholder:"\u8BF7\u8F93\u5165"})}),(0,r.jsx)(b,{name:"id",label:"\u6743\u9650\u6807\u8BC6",rules:[{required:!0},{validator:function(g,S){return I||!S?Promise.resolve():(0,n.qn)({params:{id:S},notify:!1})}},{pattern:/^[\w-]*$/,message:"\u4EC5\u5141\u8BB8\u82F1\u6587\u3001\u6570\u5B57\u548C\u201C-\u201D"}],children:(0,r.jsx)(F.Z,{placeholder:"\u8BF7\u8F93\u5165",disabled:I})}),(0,r.jsx)(b,{name:"order",label:"\u5E8F\u53F7",children:(0,r.jsx)(D.Z,{placeholder:"\u8BF7\u8F93\u5165",precision:0})}),(0,r.jsx)(b,{name:"isMenu",label:"\u662F\u5426\u5F53\u4F5C\u83DC\u5355\u4F7F\u7528\uFF1F",tooltip:"\u83DC\u5355\u6A21\u5F0F\u53EF\u4EE5\u914D\u7F6E\u5C42\u7EA7\u5173\u7CFB",rules:[{required:!0}],children:(0,r.jsx)(ae,{optionType:"button",options:ue(ee).toOpt,disabled:I})}),(0,r.jsx)(b,{dependencies:[["isMenu"],["isMicroApp"]],noStyle:!0,children:function(g){var S=g.getFieldValue,ne=g.setFieldsValue;return S(["isMenu"])&&(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(b,{name:"isMicroApp",label:"\u662F\u5426\u5F53\u4F5C\u5FAE\u5E94\u7528\u5165\u53E3\uFF1F",tooltip:"\u5FAE\u5E94\u7528\u7684\u8DEF\u7531\u5FC5\u987B\u662F\u4E2A\u6709\u6548Url",rules:[{required:!0}],children:(0,r.jsx)(ae,{optionType:"button",options:ue(ee).toOpt})}),(0,r.jsx)(b,{name:"icon",label:"icon",children:(0,r.jsx)(Pe.Z,{options:Y,allowClear:!0})}),(0,r.jsx)(b,{dependencies:["id"],noStyle:!0,children:function(){var T,re=S(["id"]),ie=(0,N.oN)({children:(0,q.Z)(Z==null||(T=Z.data)===null||T===void 0?void 0:T.data)},"children",function(H){var Q,R=H==null||(Q=H.genealogy)===null||Q===void 0?void 0:Q.includes(re);return u()(u()({},H),{},{disabled:R,name:(0,r.jsx)(p.Z,{title:R?"\u4E0D\u80FD\u9009\u5B50\u5B59\u8282\u70B9":H.url,children:H.name})})}).children;return(0,r.jsx)(b,{name:"pID",label:"\u4E0A\u7EA7\u83DC\u5355",children:(0,r.jsx)(h.Z,{fieldNames:{label:"name"},treeDefaultExpandAll:!0,placeholder:"\u8BF7\u9009\u62E9",treeNodeLabelProp:"name",treeLine:{showLeafIcon:!1},treeData:ie,showSearch:!0,filterTreeNode:te.Z,allowClear:!0,onChange:function(Q,R){var J,X;return ne({url:(0,o.isValidElement)(R==null?void 0:R[0])?R==null||(J=R[0])===null||J===void 0||(X=J.props)===null||X===void 0?void 0:X.title:void 0})}})})}}),(0,r.jsx)(b,{name:"url",label:"\u8DEF\u7531",rules:[{required:!0}],children:(0,r.jsx)(F.Z,{placeholder:"\u8BF7\u8F93\u5165"})}),(0,r.jsx)(b,{name:"isHide",label:"\u662F\u5426\u5728\u83DC\u5355\u4E2D\u9690\u85CF",tooltip:"\u5F00\u8D77\u9690\u85CF\u540E\u5C06\u4E0D\u5728\u83DC\u5355\u4E2D\u6E32\u67D3\uFF0C\u4F46\u4F9D\u65E7\u53EF\u4EE5\u901A\u8FC7url\u8BBF\u95EE",children:(0,r.jsx)(ae,{optionType:"button",options:ue(ee).toOpt})})]})}})]})},_e=e(37083),Ie=e(66022),ce=e(48023),Oe=e(98786),ve=e(81445),me=e(41896),Ae=e(95563),be=e(37401),Ze=e(21177),w=e(29878),Se=e(17674),oe=e(88760),le=Ie.Z.Link,Te=function(){var m,d,t=(0,o.useState)(),c=a()(t,2),l=c[0],s=c[1],I=(0,o.useState)([]),Z=a()(I,2),Y=Z[0],z=Z[1],W=(0,G.a)(["perm-list"],function(){return(0,n.pb)({params:{skip:0,limit:0}})},{refetchOnWindowFocus:!1}),V=(0,q.Z)((m=W.data)===null||m===void 0||(d=m.data)===null||d===void 0?void 0:d.filter(function(y){return(l==null?void 0:l.isMenu)===void 0||y.isMenu===(l==null?void 0:l.isMenu)})),g=(0,_e.Z)(),S=f.Z.useForm(),ne=a()(S,1),v=ne[0];function T(y){return _()(x()().mark(function C(){return x()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,(0,n.Vx)(u()(u()({},y),{},{isHide:!y.isHide}));case 3:W.refetch(),i.next=9;break;case 6:i.prev=6,i.t0=i.catch(0),console.warn(i.t0);case 9:case"end":return i.stop()}},C,null,[[0,6]])}))}var re=[{dataIndex:"id",title:"id",hideInSearch:!0,copyable:!0,width:200,fixed:"left",ellipsis:{padding:17}},{dataIndex:"keyword",title:"\u5173\u952E\u5B57",hideInTable:!0,fieldProps:{placeholder:"\u652F\u6301ID\u3001\u540D\u5B57\u3001\u8DEF\u7531\u6A21\u7CCA\u641C\u7D22"},tooltip:"\u652F\u6301ID\u3001\u540D\u5B57\u3001\u8DEF\u7531\u6A21\u7CCA\u641C\u7D22"},{dataIndex:"isMenu",title:"\u662F\u5426\u83DC\u5355",valueEnum:ee,width:75,fixed:"left"},{dataIndex:"isHide",title:"\u662F\u5426\u9690\u85CF",hideInSearch:!0,width:75,fixed:"left",render:function(C,A){return(0,r.jsx)(ce.Z,{title:C?"\u5F00\u542F\u540E\u5C06\u5728\u83DC\u5355\u4E2D\u53EF\u89C1":"\u9690\u85CF\u540E\u5C06\u5728\u83DC\u5355\u4E2D\u4E0D\u53EF\u89C1\uFF0C\u8DEF\u7531\u4F9D\u65E7\u751F\u6548",onConfirm:T(A),children:(0,r.jsx)(Oe.Z,{checked:C})})}},{dataIndex:"icon",title:"icon",hideInSearch:!0,width:50,align:"center",render:function(C){return C?(0,o.createElement)(E[C]):void 0}},{dataIndex:"name",title:"\u6743\u9650\u540D",hideInSearch:!0,width:150},{dataIndex:"pID",title:"\u7236\u7EA7\u83DC\u5355",hideInSearch:!0,copyable:!0,width:200,ellipsis:{padding:17,tooltip:!0}},{dataIndex:"url",title:"url",hideInSearch:!0,copyable:!0,width:200,ellipsis:{padding:17,tooltip:!0}},{dataIndex:"createAt",title:"\u521B\u5EFA\u65F6\u95F4",valueType:"dateTime",hideInSearch:!0,width:100},{dataIndex:"updateAt",title:"\u66F4\u65B0\u65F6\u95F4",valueType:"dateTime",hideInSearch:!0,width:100},{dataIndex:"id",title:"\u64CD\u4F5C",hideInSearch:!0,width:180,fixed:"right",render:function(C,A){return(0,r.jsxs)(ve.Z,{children:[A.isMenu&&(0,r.jsx)(le,{onClick:Q(A),children:"\u6DFB\u52A0\u5B50\u83DC\u5355"}),(0,r.jsx)(le,{onClick:H(A),children:"\u7F16\u8F91"}),(0,r.jsx)(ce.Z,{title:"\u64CD\u4F5C\u4E0D\u53EF\u9006\uFF0C\u8BF7\u4E8C\u6B21\u786E\u8BA4",onConfirm:R(A),children:(0,r.jsx)(le,{children:"\u5220\u9664"})})]})}}];function ie(){g.setModalProps(function(y){return u()(u()({},y),{},{open:!0,title:"\u65B0\u589E"})})}function H(y){return function(){g.setModalProps(function(C){return u()(u()({},C),{},{open:!0,title:"\u7F16\u8F91"})}),g.form.setFieldsValue(y)}}function Q(y){return function(){g.setModalProps(function(C){return u()(u()({},C),{},{open:!0,title:"\u65B0\u589E"})}),g.form.setFieldsValue({pID:y.id,url:y.url}),z(function(C){return C.concat(y.id)})}}function R(y){return _()(x()().mark(function C(){return x()().wrap(function(i){for(;;)switch(i.prev=i.next){case 0:return i.prev=0,i.next=3,(0,n.cn)(y.id,{notify:!0});case 3:W.refetch(),i.next=9;break;case 6:i.prev=6,i.t0=i.catch(0),console.warn(i.t0);case 9:case"end":return i.stop()}},C,null,[[0,6]])}))}function J(y){W.refetch()}function X(){s(void 0)}var Ue=function(C){s(C);var A=C.keyword;if(A!=null){var i=[];(0,N.ZP)({children:V},"children",function(O){var se;return(O!=null&&O.url&&(0,oe.e)(O.url,A)||O!=null&&O.name&&(0,oe.e)((se=O.name)===null||se===void 0?void 0:se.toString(),A)||O!=null&&O.id&&(0,oe.e)(O.id,A))&&(i=i.concat(O==null?void 0:O.genealogy)),!1}),z(i)}};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(xe,u()(u()({},g),{},{onSuccess:J})),(0,r.jsxs)("div",{className:"".concat(w.Z.flex," ").concat(w.Z.column),children:[(0,r.jsx)(me.Z,{children:(0,r.jsx)(Se.Z,{columns:re,formProps:{form:v,onFinish:Ue,onReset:X}})}),(0,r.jsx)(me.Z,{children:(0,r.jsxs)("div",{className:"".concat(w.Z.flex," ").concat(w.Z.column),children:[(0,r.jsx)("div",{className:"".concat(w.Z.flex," ").concat(w.Z===null||w.Z===void 0?void 0:w.Z["space-between"]),children:(0,r.jsx)("div",{children:(0,r.jsx)(ve.Z,{children:(0,r.jsx)(Ae.ZP,{icon:(0,r.jsx)(be.Z,{}),type:"primary",ghost:!0,onClick:ie,children:"\u65B0\u589E"})})})}),(0,r.jsx)(Ze.ZP,{size:"small",rowKey:"id",columns:re,scroll:{x:"max-content"},sticky:!0,columnEmptyText:"-",bordered:!0,loading:W.isFetching,expandable:{onExpandedRowsChange:z,expandedRowKeys:Y},dataSource:V,pagination:!1})]})})]})]})},Re=Te},89246:function(k,U,e){var M=e(55354),x=e.n(M),K=e(7529),u=e.n(K);function B(_,j){var a=[],o=[],n=u()(_),f;try{for(n.s();!(f=n.n()).done;){var P,F=f.value,D=x()(x()({},F),{},{label:F.name,value:F.id,genealogy:((P=j==null?void 0:j.genealogy)!==null&&P!==void 0?P:[]).concat(F.id)});F.pID===(j==null?void 0:j.id)?a.push(D):o.push(D)}}catch(te){n.e(te)}finally{n.f()}for(var p=[],h=0,E=a;h<E.length;h++){var $=E[h],G=B(o,$),N=G.matched,q=G.mismatched;p.push(x()(x()({},$),{},{children:N})),o=q}return{matched:p,mismatched:o}}U.Z=function(_){return B(_!=null?_:[]).matched}},22173:function(k,U,e){var M=e(91252),x=e(71866),K=function(B,_){return!!(_&&(0,x.ZP)(_,"children",function(j){return(0,M.h)(B,j)}))};U.Z=K},71866:function(k,U,e){e.d(U,{ZP:function(){return j},oN:function(){return a}});var M=e(50680),x=e.n(M),K=e(80211),u=e.n(K),B=e(7529),_=e.n(B);function j(n,f,P,F){var D;if(P(n,F))return n;var p,h=(D=n==null?void 0:n[f])!==null&&D!==void 0?D:[],E=_()(h),$;try{for(E.s();!($=E.n()).done;){var G=$.value;if(p=j(G,f,P,n),p)break}}catch(N){E.e(N)}finally{E.f()}return p}function a(n,f,P,F){for(var D,p=P(n,F),h=(D=p==null?void 0:p[f])!==null&&D!==void 0?D:[],E=0;E<(h==null?void 0:h.length);E++){var $=h==null?void 0:h[E];h[E]=a($,f,P,p)}return p}function o(n,f){if(_typeof(n)!=="object"||n==null)return n;for(var P=Array.isArray(n)?[]:{},F=0,D=Object.entries(n);F<D.length;F++){var p=_slicedToArray(D[F],2),h=p[0],E=p[1];P[h]=o(f(E),f)}return P}}}]);
