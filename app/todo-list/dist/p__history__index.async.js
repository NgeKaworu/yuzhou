"use strict";(self.webpackChunktodo_list_=self.webpackChunktodo_list_||[]).push([[856],{59996:function(V,O,e){e.d(O,{Z:function(){return x}});var I=e(34412),f=e.n(I),M=e(55354),E=e.n(M),Z=e(69780),A=e.n(Z),$=e(50680),y=e.n($),C=e(93981),L=e(67369),S=e(44502),T=e(29541),R=L.Z.TextArea;function x(r){var U=r.modalProps,j=r.textAearProps,b=r.onOk,a=r.tips,u=r.children,c=(0,C.useState)(!1),l=y()(c,2),_=l[0],d=l[1],v=(0,C.useState)(""),g=y()(v,2),P=g[0],B=g[1];function n(){d(!0)}function K(){d(!1)}function W(h){var s;B(h==null||(s=h.currentTarget)===null||s===void 0?void 0:s.value)}function F(){return D.apply(this,arguments)}function D(){return D=A()(f()().mark(function h(){return f()().wrap(function(m){for(;;)switch(m.prev=m.next){case 0:return m.prev=0,m.next=3,b(P);case 3:d(!1),B(""),m.next=10;break;case 7:m.prev=7,m.t0=m.catch(0),console.error(m.t0);case 10:case"end":return m.stop()}},h,null,[[0,7]])})),D.apply(this,arguments)}return(0,T.jsxs)(T.Fragment,{children:[u&&(0,C.cloneElement)(u,{onClick:n}),(0,T.jsxs)(S.Z,E()(E()({onOk:F,open:_,onCancel:K,title:"\u6279\u91CF\u5BFC\u5165"},U),{},{children:[(0,T.jsx)(R,E()({value:P,onChange:W,autoSize:{minRows:20}},j)),a]}))]})}},46219:function(V,O,e){e.d(O,{Z:function(){return b}});var I=e(59042),f=e.n(I),M=e(93981),E=e(78118),Z=e(95563),A=e(17818),$=e(54320),y=e(93829),C={card:"card___k2aYs","tools-bar":"tools-bar___dT5hB"},L=e(55354),S=e.n(L),T=e(50680),R=e.n(T),x=e(49003),r=e(29541);function U(a){var u=(0,M.useState)(a==null?void 0:a.defaultChecked),c=R()(u,2),l=c[0],_=c[1];(0,M.useEffect)(function(){_(a.defaultChecked)},[a.defaultChecked]);var d=(0,M.useRef)();function v(g){g.persist(),_(function(P){return!P}),d.current&&window.clearTimeout(d.current),d.current=window.setTimeout(function(){a!=null&&a.onClick&&(a==null||a.onClick(g))},a.interval||5e3)}return(0,r.jsx)(x.ZP,S()(S()({checked:l},a),{},{onClick:v}))}var j=e(58211),b=function(a){var u=a.onRemoveClick,c=a.onEditClick,l=a.onChange,_=a.record,d=_.id,v=_.subTask,g=_.title,P=_.level,B=_.done;function n(s){s.stopPropagation(),c(_)}function K(s){s==null||s.stopPropagation(),u(d)}function W(s){s==null||s.stopPropagation()}function F(s){l({id:d,level:s})}function D(s){var m;l({id:d,done:s==null||(m=s.target)===null||m===void 0?void 0:m.checked})}function h(s){var m,G,k,ee=s==null||(m=s.target)===null||m===void 0||(G=m.dataset)===null||G===void 0?void 0:G.originKey;l(f()({id:d},"subTask.".concat(ee,".done"),s==null||(k=s.target)===null||k===void 0?void 0:k.checked))}return(0,r.jsxs)("div",{className:C.card,children:[(0,r.jsx)(U,{onClick:D,interval:3e3,defaultChecked:B,children:(0,r.jsx)("h1",{children:g})}),(0,r.jsx)("div",{style:{marginLeft:"16px"},children:v==null?void 0:v.map(function(s,m){return(0,r.jsx)("div",{children:(0,r.jsx)(U,{"data-origin-key":m,onClick:h,interval:3e3,defaultChecked:s.done,children:s==null?void 0:s.title})},m)})}),(0,r.jsxs)("div",{className:C["tools-bar"],children:[(0,r.jsx)(E.Z,{size:"small",bordered:!1,onClick:W,onChange:F,value:P,options:j.B}),(0,r.jsx)(Z.ZP,{size:"small",type:"text",onClick:n,icon:(0,r.jsx)($.Z,{})}),(0,r.jsx)(A.Z,{title:"\u64CD\u4F5C\u4E0D\u53EF\u9006\uFF0C\u8BF7\u786E\u8BA4",onConfirm:K,onCancel:W,children:(0,r.jsx)(Z.ZP,{size:"small",type:"text",danger:!0,onClick:W,icon:(0,r.jsx)(y.Z,{})})})]})]})}},58211:function(V,O,e){e.d(O,{B:function(){return M}});var I=e(93981),f=e(29541),M=[{value:0,label:(0,f.jsx)("span",{style:{color:"green"},children:"\u4F4E"})},{value:1,label:(0,f.jsx)("span",{style:{color:"blue"},children:"\u4E2D"})},{value:2,label:(0,f.jsx)("span",{style:{color:"red"},children:"\u9AD8"})}]},68565:function(V,O,e){e.r(O);var I=e(34412),f=e.n(I),M=e(69780),E=e.n(M),Z=e(55354),A=e.n(Z),$=e(50680),y=e.n($),C=e(93981),L=e(7616),S=e(21839),T=e(95916),R=e(29895),x=e(43405),r=e(55767),U=e(44502),j=e(49003),b=e(95563),a=e(80975),u=e(67369),c=e(69086),l=e(21425),_=e(7381),d=e(81445),v=e(88556),g=e(46219),P=e(86003),B=e(59996),n=e(29541),K=x.Z.Header,W=x.Z.Content,F=x.Z.Footer,D=10,h=r.Z.Item,s={flex:1};O.default=function(){var m=r.Z.useForm(),G=y()(m,1),k=G[0],ee=r.Z.useForm(),Pe=y()(ee,1),z=Pe[0],de=(0,L.s0)(),ne=(0,L.TH)(),Q=ne.search,N=new URLSearchParams(Q),pe=(0,C.useState)(!1),_e=y()(pe,2),Ce=_e[0],te=_e[1],je=(0,C.useState)(!1),ce=y()(je,2),ge=ce[0],J=ce[1],De=(0,C.useState)(),me=y()(De,2),ae=me[0],Oe=me[1];(0,C.useEffect)(function(){var o=new URLSearchParams(Q);k.setFieldsValue(Object.fromEntries(o.entries()))},[Q]);var X=(0,S.NL)(),Y=(0,T.N)(["tasks-list",Q],function(o){var i=o.pageParam,p=i===void 0?0:i,t=Object.fromEntries(new URLSearchParams(Q));return v.iP.get("todo-list/v1/task/list",{notify:"fail",params:A()(A()({},t),{},{skip:p*D,limit:D,done:!0})})},{getNextPageParam:function(i,p){var t;return(i==null||(t=i.data)===null||t===void 0?void 0:t.length)===D?p==null?void 0:p.length:void 0}}),re=Y.data,ye=Y.isFetching,Me=Y.fetchNextPage,ve=Y.hasNextPage,oe=re==null?void 0:re.pages,H=oe==null?void 0:oe.reduce(function(o,i){return o.concat(i==null?void 0:i.data)},[]),Ae=(0,R.D)(function(o){return v.iP.post("todo-list/v1/task/create",o)}),he=(0,R.D)(function(o){return v.iP.patch("todo-list/v1/task/update",A()({id:ae==null?void 0:ae.id},o))}),Re=(0,R.D)(function(o){return v.iP.delete("todo-list/v1/task/".concat(o))});function Te(){Me()}function xe(o){return se.apply(this,arguments)}function se(){return se=E()(f()().mark(function o(i){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Ae.mutateAsync(A()(A()({},i),{},{done:!1}));case 3:X.invalidateQueries(["tasks-list"]),z.resetFields(),J(!1),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}},o,null,[[0,8]])})),se.apply(this,arguments)}function Be(){te(!1)}function fe(){k.validateFields().then(function(o){var i=o.sort,p=o.orderby;N.set("sort",i),N.set("orderby",p),de({pathname:ne.pathname,search:N.toString()}),te(!1)})}function Ue(){N.delete("sort"),N.delete("orderby"),de({pathname:ne.pathname,search:N.toString()}),k.resetFields(),te(!1)}function be(){J(!1),z.resetFields()}function Ee(){return le.apply(this,arguments)}function le(){return le=E()(f()().mark(function o(){var i;return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,z.validateFields();case 3:return i=t.sent,t.next=6,he.mutateAsync(i);case 6:X.invalidateQueries(["tasks-list"]),z.resetFields(),J(!1),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0);case 14:case"end":return t.stop()}},o,null,[[0,11]])})),le.apply(this,arguments)}function Fe(o){return ue.apply(this,arguments)}function ue(){return ue=E()(f()().mark(function o(i){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Re.mutateAsync(i);case 3:X.invalidateQueries(["tasks-list"]),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(t.t0);case 9:case"end":return t.stop()}},o,null,[[0,6]])})),ue.apply(this,arguments)}function Ie(o){return ie.apply(this,arguments)}function ie(){return ie=E()(f()().mark(function o(i){return f()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,he.mutateAsync(i);case 3:X.invalidateQueries(["tasks-list"]),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(t.t0);case 9:case"end":return t.stop()}},o,null,[[0,6]])})),ie.apply(this,arguments)}function Ze(o){z.setFieldsValue(o),Oe(o),J(!0)}function Le(o){var i=z.getFieldValue("subTask")||[],p=o.split(/\n/).reduce(function(t,w){return w!==""?t.concat({title:w,done:!1}):t},[]);z.setFieldsValue({subTask:i==null?void 0:i.concat(p)})}return(0,n.jsxs)(x.Z,{style:{height:"100%"},children:[(0,n.jsxs)(K,{className:P.Z.header,children:["\u5386\u53F2\u8BB0\u5F55",(0,n.jsx)(U.Z,{open:Ce,title:"\u6392\u5E8F",onCancel:Be,onOk:fe,children:(0,n.jsxs)(r.Z,{onFinish:fe,form:k,children:[(0,n.jsx)(h,{name:"sort",label:"\u6392\u5E8F\u5173\u952E\u5B57",rules:[{required:!0}],children:(0,n.jsxs)(j.ZP.Group,{children:[(0,n.jsx)(j.ZP.Button,{value:"reviewAt",children:"\u590D\u4E60\u65F6\u95F4"}),(0,n.jsx)(j.ZP.Button,{value:"createAt",children:"\u6DFB\u52A0\u65F6\u95F4"}),(0,n.jsx)(j.ZP.Button,{value:"exp",children:"\u719F\u7EC3\u5EA6"})]})}),(0,n.jsx)(h,{name:"orderby",label:"\u6392\u5E8F\u65B9\u5411",rules:[{required:!0}],children:(0,n.jsxs)(j.ZP.Group,{children:[(0,n.jsx)(j.ZP.Button,{value:"1",children:"\u5347\u5E8F"}),(0,n.jsx)(j.ZP.Button,{value:"-1",children:"\u964D\u5E8F"})]})}),(0,n.jsx)(h,{children:(0,n.jsx)(b.ZP,{style:{opacity:0},htmlType:"submit",children:"\u63D0\u4EA4"})}),(0,n.jsx)(h,{children:(0,n.jsx)(b.ZP,{type:"dashed",danger:!0,onClick:Ue,children:"\u53D6\u6D88\u6392\u5E8F"})})]})})]}),(0,n.jsx)(W,{style:{height:"100%",overflowY:"scroll"},children:H!=null&&H.length?(0,n.jsxs)(n.Fragment,{children:[H==null?void 0:H.map(function(o){return(0,n.jsx)(g.Z,{record:o,onEditClick:Ze,onRemoveClick:Fe,onChange:Ie},o.id)}),(0,n.jsx)(b.ZP,{type:"link",loading:ye,onClick:Te,disabled:!ve,block:!0,children:ve?"\u52A0\u8F7D\u66F4\u591A":"\u6CA1\u6709\u66F4\u591A\u4E86"})]}):(0,n.jsx)(a.Z,{className:P.Z.empty})}),(0,n.jsx)(F,{className:P.Z.footer,children:(0,n.jsx)(r.Z,{layout:"inline",initialValues:{level:0},style:s,onFinish:xe,children:"\u7B5B\u9009 undo"})}),(0,n.jsx)(U.Z,{title:"\u7F16\u8F91",open:ge,onCancel:be,onOk:Ee,children:(0,n.jsxs)(r.Z,{form:z,onFinish:Ee,wrapperCol:{span:24},labelCol:{span:24},children:[(0,n.jsx)(h,{label:"\u4E3B\u4EFB\u52A1",required:!0,style:{marginBottom:0},children:(0,n.jsx)(u.Z.Group,{children:(0,n.jsxs)(c.Z,{gutter:8,children:[(0,n.jsx)(l.Z,{span:22,children:(0,n.jsx)(h,{name:"title",rules:[{required:!0,message:"\u4EFB\u52A1\u540D\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,n.jsx)(u.Z,{})})}),(0,n.jsx)(l.Z,{span:2,style:{display:"flex",justifyContent:"center"},children:(0,n.jsx)(h,{name:"done",valuePropName:"checked",children:(0,n.jsx)(_.Z,{})})})]})})}),(0,n.jsx)(r.Z.List,{name:"subTask",children:function(i,p){var t=p.add,w=p.remove;function Se(){t()}return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(h,{label:(0,n.jsxs)(d.Z,{size:"large",children:["\u5B50\u4EFB\u52A1",(0,n.jsx)("a",{onClick:Se,children:"\u6DFB\u52A0\u4E00\u9879"}),(0,n.jsx)(B.Z,{onOk:Le,tips:"\u8F93\u5165\u7A7A\u683C\u6216\u6362\u884C\u5206\u5272\u5B50\u4EFB\u52A1",children:(0,n.jsx)("a",{children:"\u6279\u91CF\u6DFB\u52A0"})})]}),required:!0,children:i.map(function(q){function Ke(){w(q.name)}return(0,n.jsx)(h,{style:{marginBottom:0},children:(0,n.jsx)(u.Z.Group,{children:(0,n.jsxs)(c.Z,{gutter:8,children:[(0,n.jsx)(l.Z,{span:20,children:(0,n.jsx)(h,{name:[q.name,"title"],rules:[{required:!0,message:"\u5B50\u4EFB\u52A1\u540D\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,n.jsx)(u.Z,{})})}),(0,n.jsx)(l.Z,{span:2,style:{display:"flex",justifyContent:"center"},children:(0,n.jsx)(h,{name:[q.name,"done"],valuePropName:"checked",children:(0,n.jsx)(_.Z,{})})}),(0,n.jsx)(l.Z,{span:2,children:(0,n.jsx)(h,{children:(0,n.jsx)("a",{onClick:Ke,children:"\u5220\u9664"})})})]})})},q.key)})})})}}),(0,n.jsx)(h,{children:(0,n.jsx)(b.ZP,{style:{opacity:0},htmlType:"submit",children:"\u63D0\u4EA4"})})]})})]})}},88556:function(V,O,e){e.d(O,{iP:function(){return r}});var I=e(59042),f=e.n(I),M=e(55354),E=e.n(M),Z=e(11135),A=e(33813),$=e(93981),y=e.t($,2),C=e(32841),L=e(17635),S={antd:Z,reactQuery:A,react:y,reactDnD:C,reactRouterDom:L},T=e(28983),R=S.antd.message,x={200:"\u64CD\u4F5C\u6210\u529F\u3002",201:"\u65B0\u5EFA\u6216\u4FEE\u6539\u6570\u636E\u6210\u529F\u3002",202:"\u4E00\u4E2A\u8BF7\u6C42\u5DF2\u7ECF\u8FDB\u5165\u540E\u53F0\u6392\u961F\uFF08\u5F02\u6B65\u4EFB\u52A1\uFF09\u3002",204:"\u5220\u9664\u6570\u636E\u6210\u529F\u3002",400:"\u53D1\u51FA\u7684\u8BF7\u6C42\u6709\u9519\u8BEF\uFF0C\u670D\u52A1\u5668\u6CA1\u6709\u8FDB\u884C\u65B0\u5EFA\u6216\u4FEE\u6539\u6570\u636E\u7684\u64CD\u4F5C\u3002",401:"\u7528\u6237\u6CA1\u6709\u6743\u9650\uFF08\u4EE4\u724C\u3001\u7528\u6237\u540D\u3001\u5BC6\u7801\u9519\u8BEF\uFF09\u3002",403:"\u7528\u6237\u5F97\u5230\u6388\u6743\uFF0C\u4F46\u662F\u8BBF\u95EE\u662F\u88AB\u7981\u6B62\u7684\u3002",404:"\u53D1\u51FA\u7684\u8BF7\u6C42\u9488\u5BF9\u7684\u662F\u4E0D\u5B58\u5728\u7684\u8BB0\u5F55\uFF0C\u670D\u52A1\u5668\u6CA1\u6709\u8FDB\u884C\u64CD\u4F5C\u3002",405:"\u8BF7\u6C42\u65B9\u5F0F\u4E0D\u5BF9",406:"\u8BF7\u6C42\u7684\u683C\u5F0F\u4E0D\u53EF\u5F97\u3002",410:"\u8BF7\u6C42\u7684\u8D44\u6E90\u88AB\u6C38\u4E45\u5220\u9664\uFF0C\u4E14\u4E0D\u4F1A\u518D\u5F97\u5230\u7684\u3002",422:"\u5F53\u521B\u5EFA\u4E00\u4E2A\u5BF9\u8C61\u65F6\uFF0C\u53D1\u751F\u4E00\u4E2A\u9A8C\u8BC1\u9519\u8BEF\u3002",500:"\u670D\u52A1\u5668\u53D1\u751F\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u670D\u52A1\u5668\u3002",502:"\u7F51\u5173\u9519\u8BEF\u3002",503:"\u670D\u52A1\u4E0D\u53EF\u7528\uFF0C\u670D\u52A1\u5668\u6682\u65F6\u8FC7\u8F7D\u6216\u7EF4\u62A4\u3002",504:"\u7F51\u5173\u8D85\u65F6\u3002"},r=T.Z.create({baseURL:"/api/",timeout:1e4,timeoutErrorMessage:"\u8FDE\u63A5\u8D85\u65F6\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u540E\u518D\u8BD5"});r.interceptors.request.use(function(a){return a.headers.setAuthorization("Bearer ".concat(localStorage.getItem("token"))),a}),r.interceptors.response.use(function(a){var u,c;if(a!=null&&(u=a.data)!==null&&u!==void 0&&u.ok)return a;var l={config:a.config,isAxiosError:!1,toJSON:function(){return{}},response:a,request:a.request,message:a==null||(c=a.data)===null||c===void 0?void 0:c.errMsg,name:"biz error"};throw l}),r.interceptors.response.use(function(a){var u,c,l=a.data,_=a.config;if((u=[!0,"success"])!==null&&u!==void 0&&u.includes((c=_==null?void 0:_.notify)!==null&&c!==void 0?c:!1)){var d=(l==null?void 0:l.message)||"\u64CD\u4F5C\u6210\u529F";R.success({content:d,key:d})}return l}),r.interceptors.response.use(void 0,function(a){var u,c=a!=null?a:{},l=c.response,_=c.message,d=c.config,v=d!=null?d:{},g=v.reAuth,P=v.notify,B=v.sneakyThrows;if((l==null?void 0:l.status)===401)return g?U(d):R.warning({key:l.status,content:"\u8BF7\u5148\u767B\u5F55",onClose:function(){var F,D;localStorage.removeItem("token"),(F=location.pathname)!==null&&F!==void 0&&(D=F.toLocaleLowerCase())!==null&&D!==void 0&&D.includes("/user-center/login/")||location.replace("/user-center/login/")}});if((u=[!0,"fail"])!==null&&u!==void 0&&u.includes(P!=null?P:!0)){var n=_.match("Network Error")&&"\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u3002",K=n||_||x[l==null?void 0:l.status]||"\u672A\u77E5\u9519\u8BEF";R.error({key:K,content:K})}if(B)return l;throw a});function U(a){return r.get("/uc/oauth2/refresh",{reAuth:!1,notify:"fail",params:{token:localStorage.getStorage("refresh_token")}}).then(function(u){return localStorage.setItem("token",u.data.token),localStorage.setItem("refresh_token",u.data.refresh_token),r(E()(E()({},a),{},{reAuth:!1}))})}var j=["query","mutation"],b=j.reduce(function(a,u){return E()(E()({},a),{},f()({},u,function(c,l){return function(){for(var _=arguments.length,d=new Array(_),v=0;v<_;v++)d[v]=arguments[v];return r.post(c,E()({query:"".concat(u," {").concat(d[0].reduce(function(g,P,B){return g+P+(d[B+1]||"")},""),"}")},l))}}))},{})},86003:function(V,O){O.Z={header:"header___bRScu",footer:"footer___QOC7J",empty:"empty___HT1XX"}}}]);
