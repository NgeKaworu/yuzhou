"use strict";(self.webpackChunktodo_list_=self.webpackChunktodo_list_||[]).push([[119],{59996:function(V,g,e){e.d(g,{Z:function(){return B}});var I=e(34412),v=e.n(I),A=e(55354),f=e.n(A),Z=e(69780),C=e.n(Z),z=e(50680),O=e.n(z),j=e(93981),L=e(67369),b=e(44502),x=e(29541),R=L.Z.TextArea;function B(o){var D=o.modalProps,S=o.textAearProps,y=o.onOk,a=o.tips,c=o.children,m=(0,j.useState)(!1),u=O()(m,2),i=u[0],d=u[1],h=(0,j.useState)(""),E=O()(h,2),p=E[0],M=E[1];function $(){d(!0)}function K(){d(!1)}function n(F){var s;M(F==null||(s=F.currentTarget)===null||s===void 0?void 0:s.value)}function U(){return T.apply(this,arguments)}function T(){return T=C()(v()().mark(function F(){return v()().wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return r.prev=0,r.next=3,y(p);case 3:d(!1),M(""),r.next=10;break;case 7:r.prev=7,r.t0=r.catch(0),console.error(r.t0);case 10:case"end":return r.stop()}},F,null,[[0,7]])})),T.apply(this,arguments)}return(0,x.jsxs)(x.Fragment,{children:[c&&(0,j.cloneElement)(c,{onClick:$}),(0,x.jsxs)(b.Z,f()(f()({onOk:U,open:i,onCancel:K,title:"\u6279\u91CF\u5BFC\u5165"},D),{},{children:[(0,x.jsx)(R,f()({value:p,onChange:n,autoSize:{minRows:20}},S)),a]}))]})}},46219:function(V,g,e){e.d(g,{Z:function(){return y}});var I=e(59042),v=e.n(I),A=e(93981),f=e(78118),Z=e(95563),C=e(17818),z=e(54320),O=e(93829),j={card:"card___k2aYs","tools-bar":"tools-bar___dT5hB"},L=e(55354),b=e.n(L),x=e(50680),R=e.n(x),B=e(49003),o=e(29541);function D(a){var c=(0,A.useState)(a==null?void 0:a.defaultChecked),m=R()(c,2),u=m[0],i=m[1];(0,A.useEffect)(function(){i(a.defaultChecked)},[a.defaultChecked]);var d=(0,A.useRef)();function h(E){E.persist(),i(function(p){return!p}),d.current&&window.clearTimeout(d.current),d.current=window.setTimeout(function(){a!=null&&a.onClick&&(a==null||a.onClick(E))},a.interval||5e3)}return(0,o.jsx)(B.ZP,b()(b()({checked:u},a),{},{onClick:h}))}var S=e(58211),y=function(a){var c=a.onRemoveClick,m=a.onEditClick,u=a.onChange,i=a.record,d=i.id,h=i.subTask,E=i.title,p=i.level,M=i.done;function $(s){s.stopPropagation(),m(i)}function K(s){s==null||s.stopPropagation(),c(d)}function n(s){s==null||s.stopPropagation()}function U(s){u({id:d,level:s})}function T(s){var r;u({id:d,done:s==null||(r=s.target)===null||r===void 0?void 0:r.checked})}function F(s){var r,G,W,ne=s==null||(r=s.target)===null||r===void 0||(G=r.dataset)===null||G===void 0?void 0:G.originKey;u(v()({id:d},"subTask.".concat(ne,".done"),s==null||(W=s.target)===null||W===void 0?void 0:W.checked))}return(0,o.jsxs)("div",{className:j.card,children:[(0,o.jsx)(D,{onClick:T,interval:3e3,defaultChecked:M,children:(0,o.jsx)("h1",{children:E})}),(0,o.jsx)("div",{style:{marginLeft:"16px"},children:h==null?void 0:h.map(function(s,r){return(0,o.jsx)("div",{children:(0,o.jsx)(D,{"data-origin-key":r,onClick:F,interval:3e3,defaultChecked:s.done,children:s==null?void 0:s.title})},r)})}),(0,o.jsxs)("div",{className:j["tools-bar"],children:[(0,o.jsx)(f.Z,{size:"small",bordered:!1,onClick:n,onChange:U,value:p,options:S.B}),(0,o.jsx)(Z.ZP,{size:"small",type:"text",onClick:$,icon:(0,o.jsx)(z.Z,{})}),(0,o.jsx)(C.Z,{title:"\u64CD\u4F5C\u4E0D\u53EF\u9006\uFF0C\u8BF7\u786E\u8BA4",onConfirm:K,onCancel:n,children:(0,o.jsx)(Z.ZP,{size:"small",type:"text",danger:!0,onClick:n,icon:(0,o.jsx)(O.Z,{})})})]})]})}},58211:function(V,g,e){e.d(g,{B:function(){return A}});var I=e(93981),v=e(29541),A=[{value:0,label:(0,v.jsx)("span",{style:{color:"green"},children:"\u4F4E"})},{value:1,label:(0,v.jsx)("span",{style:{color:"blue"},children:"\u4E2D"})},{value:2,label:(0,v.jsx)("span",{style:{color:"red"},children:"\u9AD8"})}]},46217:function(V,g,e){e.r(g);var I=e(34412),v=e.n(I),A=e(69780),f=e.n(A),Z=e(55354),C=e.n(Z),z=e(50680),O=e.n(z),j=e(93981),L=e(7616),b=e(21839),x=e(95916),R=e(29895),B=e(43405),o=e(55767),D=e(67369),S=e(44502),y=e(49003),a=e(95563),c=e(80975),m=e(78118),u=e(69086),i=e(21425),d=e(7381),h=e(81445),E=e(88556),p=e(46219),M=e(86003),$=e(59996),K=e(58211),n=e(29541),U=B.Z.Header,T=B.Z.Content,F=B.Z.Footer,s=0,r=o.Z.Item,G=D.Z.Group,W={flex:1};g.default=function(){var ne=o.Z.useForm(),Pe=O()(ne,1),J=Pe[0],pe=o.Z.useForm(),Ce=O()(pe,1),k=Ce[0],de=(0,L.s0)(),te=(0,L.TH)(),Q=te.search,H=new URLSearchParams(Q),je=(0,j.useState)(!1),_e=O()(je,2),De=_e[0],X=_e[1],ge=(0,j.useState)(!1),ce=O()(ge,2),Oe=ce[0],Y=ce[1],ye=(0,j.useState)(),me=O()(ye,2),ae=me[0],Me=me[1];(0,j.useEffect)(function(){var l=new URLSearchParams(Q);J.setFieldsValue(Object.fromEntries(l.entries()))},[Q]);var w=(0,b.NL)(),ve=(0,x.N)(["tasks-list",Q],function(l){var _=l.pageParam,P=_===void 0?0:_,t=Object.fromEntries(new URLSearchParams(Q));return E.iP.get("todo-list/v1/task/list",{notify:"fail",params:C()(C()({},t),{},{skip:P*s,limit:s})})},{getNextPageParam:function(_,P){var t;return(_==null||(t=_.data)===null||t===void 0?void 0:t.length)===s?P==null?void 0:P.length:void 0}}),re=ve.data,Ae=ve.isFetching,oe=re==null?void 0:re.pages,N=oe==null?void 0:oe.reduce(function(l,_){return l.concat(_==null?void 0:_.data)},[]),Re=(0,R.D)(function(l){return E.iP.post("todo-list/v1/task/create",l)}),he=(0,R.D)(function(l){return E.iP.patch("todo-list/v1/task/update",C()({id:ae==null?void 0:ae.id},l))}),Te=(0,R.D)(function(l){return E.iP.delete("todo-list/v1/task/".concat(l))});function xe(l){return se.apply(this,arguments)}function se(){return se=f()(v()().mark(function l(_){return v()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Re.mutateAsync(C()(C()({},_),{},{done:!1}));case 3:w.invalidateQueries(["tasks-list"]),k.resetFields(),Y(!1),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error(t.t0);case 11:case"end":return t.stop()}},l,null,[[0,8]])})),se.apply(this,arguments)}function We(){X(!0)}function Be(){X(!1)}function fe(){J.validateFields().then(function(l){var _=l.sort,P=l.orderby;H.set("sort",_),H.set("orderby",P),de({pathname:te.pathname,search:H.toString()}),X(!1)})}function Ue(){H.delete("sort"),H.delete("orderby"),de({pathname:te.pathname,search:H.toString()}),J.resetFields(),X(!1)}function Fe(){Y(!1),k.resetFields()}function Ee(){return le.apply(this,arguments)}function le(){return le=f()(v()().mark(function l(){var _;return v()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,k.validateFields();case 3:return _=t.sent,t.next=6,he.mutateAsync(_);case 6:w.invalidateQueries(["tasks-list"]),k.resetFields(),Y(!1),t.next=14;break;case 11:t.prev=11,t.t0=t.catch(0),console.error(t.t0);case 14:case"end":return t.stop()}},l,null,[[0,11]])})),le.apply(this,arguments)}function Ie(l){return ue.apply(this,arguments)}function ue(){return ue=f()(v()().mark(function l(_){return v()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,Te.mutateAsync(_);case 3:w.invalidateQueries(["tasks-list"]),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(t.t0);case 9:case"end":return t.stop()}},l,null,[[0,6]])})),ue.apply(this,arguments)}function Ze(l){return ie.apply(this,arguments)}function ie(){return ie=f()(v()().mark(function l(_){return v()().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,he.mutateAsync(_);case 3:w.invalidateQueries(["tasks-list"]),t.next=9;break;case 6:t.prev=6,t.t0=t.catch(0),console.error(t.t0);case 9:case"end":return t.stop()}},l,null,[[0,6]])})),ie.apply(this,arguments)}function Le(l){k.setFieldsValue(l),Me(l),Y(!0)}function be(l){var _=k.getFieldValue("subTask")||[],P=l.split(/\n/).reduce(function(t,q){return q!==""?t.concat({title:q,done:!1}):t},[]);k.setFieldsValue({subTask:_==null?void 0:_.concat(P)})}return(0,n.jsxs)(B.Z,{style:{height:"100%"},children:[(0,n.jsxs)(U,{className:M.Z.header,children:["\u6240\u6709\u5F85\u529E",(0,n.jsx)(S.Z,{open:De,title:"\u6392\u5E8F",onCancel:Be,onOk:fe,children:(0,n.jsxs)(o.Z,{onFinish:fe,form:J,children:[(0,n.jsx)(r,{name:"sort",label:"\u6392\u5E8F\u5173\u952E\u5B57",rules:[{required:!0}],children:(0,n.jsxs)(y.ZP.Group,{children:[(0,n.jsx)(y.ZP.Button,{value:"reviewAt",children:"\u590D\u4E60\u65F6\u95F4"}),(0,n.jsx)(y.ZP.Button,{value:"createAt",children:"\u6DFB\u52A0\u65F6\u95F4"}),(0,n.jsx)(y.ZP.Button,{value:"exp",children:"\u719F\u7EC3\u5EA6"})]})}),(0,n.jsx)(r,{name:"orderby",label:"\u6392\u5E8F\u65B9\u5411",rules:[{required:!0}],children:(0,n.jsxs)(y.ZP.Group,{children:[(0,n.jsx)(y.ZP.Button,{value:"1",children:"\u5347\u5E8F"}),(0,n.jsx)(y.ZP.Button,{value:"-1",children:"\u964D\u5E8F"})]})}),(0,n.jsx)(r,{children:(0,n.jsx)(a.ZP,{style:{opacity:0},htmlType:"submit",children:"\u63D0\u4EA4"})}),(0,n.jsx)(r,{children:(0,n.jsx)(a.ZP,{type:"dashed",danger:!0,onClick:Ue,children:"\u53D6\u6D88\u6392\u5E8F"})})]})})]}),(0,n.jsx)(T,{style:{height:"100%",overflowY:"scroll"},children:N!=null&&N.length?N==null?void 0:N.map(function(l){return(0,n.jsx)(p.Z,{record:l,onEditClick:Le,onRemoveClick:Ie,onChange:Ze},l.id)}):(0,n.jsx)(c.Z,{className:M.Z.empty})}),(0,n.jsx)(F,{className:M.Z.footer,children:(0,n.jsx)(o.Z,{layout:"inline",initialValues:{level:0},style:W,onFinish:xe,children:(0,n.jsxs)(G,{compact:!0,style:C()(C()({},W),{},{display:"flex"}),children:[(0,n.jsx)(r,{name:"level",rules:[{required:!0,message:"\b\u8BF7\u9009\u62E9\u4F18\u5148\u7EA7"}],children:(0,n.jsx)(m.Z,{placeholder:"\u4F18\u5148\u7EA7",options:K.B,dropdownMatchSelectWidth:!1})}),(0,n.jsx)(r,{name:"title",rules:[{required:!0,message:"\u8BF7\u8F93\u5165\u4EFB\u52A1\u540D\b"}],style:W,children:(0,n.jsx)(D.Z,{placeholder:"\u6DFB\u52A0\u4EFB\u52A1",style:W})}),(0,n.jsx)(r,{style:{marginRight:0},children:(0,n.jsx)(a.ZP,{type:"primary",htmlType:"submit",loading:Ae,children:"\u65B0\u589E"})})]})})}),(0,n.jsx)(S.Z,{title:"\u7F16\u8F91",open:Oe,onCancel:Fe,onOk:Ee,children:(0,n.jsxs)(o.Z,{form:k,onFinish:Ee,wrapperCol:{span:24},labelCol:{span:24},children:[(0,n.jsx)(r,{label:"\u4E3B\u4EFB\u52A1",required:!0,style:{marginBottom:0},children:(0,n.jsx)(D.Z.Group,{children:(0,n.jsxs)(u.Z,{gutter:8,children:[(0,n.jsx)(i.Z,{span:22,children:(0,n.jsx)(r,{name:"title",rules:[{required:!0,message:"\u4EFB\u52A1\u540D\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,n.jsx)(D.Z,{})})}),(0,n.jsx)(i.Z,{span:2,style:{display:"flex",justifyContent:"center"},children:(0,n.jsx)(r,{name:"done",valuePropName:"checked",children:(0,n.jsx)(d.Z,{})})})]})})}),(0,n.jsx)(o.Z.List,{name:"subTask",children:function(_,P){var t=P.add,q=P.remove;function Se(){t()}return(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(r,{label:(0,n.jsxs)(h.Z,{size:"large",children:["\u5B50\u4EFB\u52A1",(0,n.jsx)("a",{onClick:Se,children:"\u6DFB\u52A0\u4E00\u9879"}),(0,n.jsx)($.Z,{onOk:be,tips:"\u8F93\u5165\u7A7A\u683C\u6216\u6362\u884C\u5206\u5272\u5B50\u4EFB\u52A1",children:(0,n.jsx)("a",{children:"\u6279\u91CF\u6DFB\u52A0"})})]}),required:!0,children:_.map(function(ee){function Ke(){q(ee.name)}return(0,n.jsx)(r,{style:{marginBottom:0},children:(0,n.jsx)(D.Z.Group,{children:(0,n.jsxs)(u.Z,{gutter:8,children:[(0,n.jsx)(i.Z,{span:20,children:(0,n.jsx)(r,{name:[ee.name,"title"],rules:[{required:!0,message:"\u5B50\u4EFB\u52A1\u540D\u4E0D\u80FD\u4E3A\u7A7A"}],children:(0,n.jsx)(D.Z,{})})}),(0,n.jsx)(i.Z,{span:2,style:{display:"flex",justifyContent:"center"},children:(0,n.jsx)(r,{name:[ee.name,"done"],valuePropName:"checked",children:(0,n.jsx)(d.Z,{})})}),(0,n.jsx)(i.Z,{span:2,children:(0,n.jsx)(r,{children:(0,n.jsx)("a",{onClick:Ke,children:"\u5220\u9664"})})})]})})},ee.key)})})})}}),(0,n.jsx)(r,{children:(0,n.jsx)(a.ZP,{style:{opacity:0},htmlType:"submit",children:"\u63D0\u4EA4"})})]})})]})}},88556:function(V,g,e){e.d(g,{iP:function(){return o}});var I=e(59042),v=e.n(I),A=e(55354),f=e.n(A),Z=e(11135),C=e(33813),z=e(93981),O=e.t(z,2),j=e(32841),L=e(17635),b={antd:Z,reactQuery:C,react:O,reactDnD:j,reactRouterDom:L},x=e(28983),R=b.antd.message,B={200:"\u64CD\u4F5C\u6210\u529F\u3002",201:"\u65B0\u5EFA\u6216\u4FEE\u6539\u6570\u636E\u6210\u529F\u3002",202:"\u4E00\u4E2A\u8BF7\u6C42\u5DF2\u7ECF\u8FDB\u5165\u540E\u53F0\u6392\u961F\uFF08\u5F02\u6B65\u4EFB\u52A1\uFF09\u3002",204:"\u5220\u9664\u6570\u636E\u6210\u529F\u3002",400:"\u53D1\u51FA\u7684\u8BF7\u6C42\u6709\u9519\u8BEF\uFF0C\u670D\u52A1\u5668\u6CA1\u6709\u8FDB\u884C\u65B0\u5EFA\u6216\u4FEE\u6539\u6570\u636E\u7684\u64CD\u4F5C\u3002",401:"\u7528\u6237\u6CA1\u6709\u6743\u9650\uFF08\u4EE4\u724C\u3001\u7528\u6237\u540D\u3001\u5BC6\u7801\u9519\u8BEF\uFF09\u3002",403:"\u7528\u6237\u5F97\u5230\u6388\u6743\uFF0C\u4F46\u662F\u8BBF\u95EE\u662F\u88AB\u7981\u6B62\u7684\u3002",404:"\u53D1\u51FA\u7684\u8BF7\u6C42\u9488\u5BF9\u7684\u662F\u4E0D\u5B58\u5728\u7684\u8BB0\u5F55\uFF0C\u670D\u52A1\u5668\u6CA1\u6709\u8FDB\u884C\u64CD\u4F5C\u3002",405:"\u8BF7\u6C42\u65B9\u5F0F\u4E0D\u5BF9",406:"\u8BF7\u6C42\u7684\u683C\u5F0F\u4E0D\u53EF\u5F97\u3002",410:"\u8BF7\u6C42\u7684\u8D44\u6E90\u88AB\u6C38\u4E45\u5220\u9664\uFF0C\u4E14\u4E0D\u4F1A\u518D\u5F97\u5230\u7684\u3002",422:"\u5F53\u521B\u5EFA\u4E00\u4E2A\u5BF9\u8C61\u65F6\uFF0C\u53D1\u751F\u4E00\u4E2A\u9A8C\u8BC1\u9519\u8BEF\u3002",500:"\u670D\u52A1\u5668\u53D1\u751F\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u670D\u52A1\u5668\u3002",502:"\u7F51\u5173\u9519\u8BEF\u3002",503:"\u670D\u52A1\u4E0D\u53EF\u7528\uFF0C\u670D\u52A1\u5668\u6682\u65F6\u8FC7\u8F7D\u6216\u7EF4\u62A4\u3002",504:"\u7F51\u5173\u8D85\u65F6\u3002"},o=x.Z.create({baseURL:"/api/",timeout:1e4,timeoutErrorMessage:"\u8FDE\u63A5\u8D85\u65F6\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u540E\u518D\u8BD5"});o.interceptors.request.use(function(a){return a.headers.setAuthorization("Bearer ".concat(localStorage.getItem("token"))),a}),o.interceptors.response.use(function(a){var c,m;if(a!=null&&(c=a.data)!==null&&c!==void 0&&c.ok)return a;var u={config:a.config,isAxiosError:!1,toJSON:function(){return{}},response:a,request:a.request,message:a==null||(m=a.data)===null||m===void 0?void 0:m.errMsg,name:"biz error"};throw u}),o.interceptors.response.use(function(a){var c,m,u=a.data,i=a.config;if((c=[!0,"success"])!==null&&c!==void 0&&c.includes((m=i==null?void 0:i.notify)!==null&&m!==void 0?m:!1)){var d=(u==null?void 0:u.message)||"\u64CD\u4F5C\u6210\u529F";R.success({content:d,key:d})}return u}),o.interceptors.response.use(void 0,function(a){var c,m=a!=null?a:{},u=m.response,i=m.message,d=m.config,h=d!=null?d:{},E=h.reAuth,p=h.notify,M=h.sneakyThrows;if((u==null?void 0:u.status)===401)return E?D(d):R.warning({key:u.status,content:"\u8BF7\u5148\u767B\u5F55",onClose:function(){var U,T;localStorage.removeItem("token"),(U=location.pathname)!==null&&U!==void 0&&(T=U.toLocaleLowerCase())!==null&&T!==void 0&&T.includes("/user-center/login/")||location.replace("/user-center/login/")}});if((c=[!0,"fail"])!==null&&c!==void 0&&c.includes(p!=null?p:!0)){var $=i.match("Network Error")&&"\u7F51\u7EDC\u9519\u8BEF\uFF0C\u8BF7\u68C0\u67E5\u7F51\u7EDC\u3002",K=$||i||B[u==null?void 0:u.status]||"\u672A\u77E5\u9519\u8BEF";R.error({key:K,content:K})}if(M)return u;throw a});function D(a){return o.get("/uc/oauth2/refresh",{reAuth:!1,notify:"fail",params:{token:localStorage.getStorage("refresh_token")}}).then(function(c){return localStorage.setItem("token",c.data.token),localStorage.setItem("refresh_token",c.data.refresh_token),o(f()(f()({},a),{},{reAuth:!1}))})}var S=["query","mutation"],y=S.reduce(function(a,c){return f()(f()({},a),{},v()({},c,function(m,u){return function(){for(var i=arguments.length,d=new Array(i),h=0;h<i;h++)d[h]=arguments[h];return o.post(m,f()({query:"".concat(c," {").concat(d[0].reduce(function(E,p,M){return E+p+(d[M+1]||"")},""),"}")},u))}}))},{})},86003:function(V,g){g.Z={header:"header___bRScu",footer:"footer___QOC7J",empty:"empty___HT1XX"}}}]);
